# è°ƒè¯•æŠ¥å‘Š8 - è‚¡ç¥¨Kçº¿å›¾é¢„è§ˆåŠŸèƒ½å®ç°

## ğŸ“‹ éœ€æ±‚æ¦‚è¿°

æ ¹æ®`è‚¡ç¥¨é¢„è§ˆæ¨¡å—0.1.md`æ–‡æ¡£è¦æ±‚ï¼Œå¯¹è‚¡ç¥¨é¢„è§ˆåŠŸèƒ½è¿›è¡Œä»¥ä¸‹è°ƒæ•´ï¼š

1. âœ… ä½¿ç”¨Kçº¿å›¾æ›¿ä»£è¡¨æ ¼å±•ç¤ºæ•°æ®
2. âœ… ä¾æ¬¡å±•ç¤º1åˆ†é’ŸKï¼ˆé»˜è®¤2å¤©ï¼‰ã€æ—¥Kï¼ˆé»˜è®¤60å¤©ï¼‰ã€å‘¨Kï¼ˆé»˜è®¤360å¤©ï¼‰
3. âœ… æ”¯æŒåå­—æ˜Ÿå…‰æ ‡å’Œé”®ç›˜ç¼©æ”¾åŠŸèƒ½
4. âœ… å®ç°è‡ªåŠ¨å®šæ—¶æ›´æ–°æœºåˆ¶ï¼ˆ1åˆ†é’ŸKæ¯5åˆ†é’Ÿï¼Œæ—¥K/å‘¨Kæ¯24å°æ—¶ï¼‰
5. âœ… ç§»é™¤AIåˆ†ææŒ‰é’®

---

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. æ•°æ®åº“ç»“æ„æ‰©å±•

#### æ–°å¢è¡¨ï¼š`stock_minute` (1åˆ†é’ŸKçº¿æ•°æ®)

```sql
CREATE TABLE IF NOT EXISTS stock_minute (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    ts_code TEXT NOT NULL,
    trade_time TIMESTAMP NOT NULL,
    open REAL,
    high REAL,
    low REAL,
    close REAL,
    volume INTEGER,
    amount REAL,
    UNIQUE(ts_code, trade_time)
)
```

**ç´¢å¼•ä¼˜åŒ–**ï¼š
- `idx_stock_minute_ts_code`: æŒ‰è‚¡ç¥¨ä»£ç ç´¢å¼•
- `idx_stock_minute_trade_time`: æŒ‰äº¤æ˜“æ—¶é—´ç´¢å¼•

**æ–‡ä»¶ä½ç½®**ï¼š`database/db_manager_sqlite.py`

---

### 2. æ•°æ®è·å–é€»è¾‘

#### æ–°å¢æ–¹æ³•ï¼š`fetch_minute_data()` 

```python
def fetch_minute_data(self, stock_code, freq='1min'):
    """è·å–åˆ†é’ŸKçº¿æ•°æ®
    
    Args:
        stock_code: è‚¡ç¥¨ä»£ç 
        freq: é¢‘ç‡ï¼Œé»˜è®¤1minï¼Œå¯é€‰ï¼š1min, 5min, 15min, 30min, 60min
    
    Returns:
        æœ€è¿‘2å¤©çš„åˆ†é’ŸKçº¿æ•°æ®ï¼ˆ1440åˆ†é’Ÿï¼‰
    """
    # ä½¿ç”¨Tushareçš„pro_baræ¥å£
    df = ts.pro_bar(
        ts_code=ts_code,
        freq=freq,
        start_date=start_date.strftime('%Y%m%d'),
        end_date=end_date.strftime('%Y%m%d'),
        adj='qfq',  # å‰å¤æƒ
        asset='E'   # è‚¡ç¥¨
    )
```

**æ³¨æ„äº‹é¡¹**ï¼š
- æ¸¯è‚¡æš‚ä¸æ”¯æŒåˆ†é’Ÿæ•°æ®
- åªä¿ç•™æœ€è¿‘1440åˆ†é’Ÿï¼ˆ2ä¸ªäº¤æ˜“æ—¥ï¼‰çš„æ•°æ®
- æ•°æ®è‡ªåŠ¨å‰å¤æƒå¤„ç†

#### æ–°å¢æ–¹æ³•ï¼š`save_minute_data()`

```python
def save_minute_data(self, data_list):
    """ä¿å­˜åˆ†é’ŸKçº¿æ•°æ®åˆ°æ•°æ®åº“"""
    query = """
    INSERT OR REPLACE INTO stock_minute (ts_code, trade_time, open, high, low, close, volume, amount)
    VALUES (%s, %s, %s, %s, %s, %s, %s, %s)
    """
```

#### ä¿®æ”¹æ–¹æ³•ï¼š`update_stock_data()`

```python
def update_stock_data(self, stock_code):
    """æ›´æ–°è‚¡ç¥¨æ•°æ®ï¼ˆåˆ†é’ŸKã€æ—¥Kçº¿ã€å‘¨Kçº¿ã€æŒ‡æ ‡ï¼‰"""
    # 1. è·å–1åˆ†é’ŸKçº¿æ•°æ®
    minute_data = self.fetch_minute_data(stock_code)
    if minute_data:
        self.save_minute_data(minute_data)
    
    # 2. è·å–æ—¥Kçº¿æ•°æ®
    # 3. è·å–å‘¨Kçº¿æ•°æ®
    # 4. è®¡ç®—å¹¶ä¿å­˜æŠ€æœ¯æŒ‡æ ‡
```

**æ–‡ä»¶ä½ç½®**ï¼š`services/stock_service.py`

---

### 3. å‰ç«¯Kçº¿å›¾é›†æˆ

#### å¼•å…¥EChartsåº“

åœ¨`templates/base.html`ä¸­æ·»åŠ ï¼š

```html
<!-- ECharts for K-line charts -->
<script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
```

#### é¡µé¢å¸ƒå±€è°ƒæ•´

**ä¿®æ”¹å‰**ï¼š
```html
<div id="stockDataContainer">
    <table class="data-table">...</table>
</div>
```

**ä¿®æ”¹å**ï¼š
```html
<!-- 1åˆ†é’ŸKçº¿å›¾ -->
<div class="card chart-container">
    <div class="chart-header">
        <span class="chart-title">ğŸ“ˆ 1åˆ†é’ŸKçº¿ï¼ˆ2å¤©çª—å£ï¼‰</span>
    </div>
    <div id="minuteChart" style="width: 100%; height: 300px;"></div>
</div>

<!-- æ—¥Kçº¿å›¾ -->
<div class="card chart-container">
    <div class="chart-header">
        <span class="chart-title">ğŸ“Š æ—¥Kçº¿ï¼ˆ60å¤©çª—å£ï¼‰</span>
    </div>
    <div id="dailyChart" style="width: 100%; height: 350px;"></div>
</div>

<!-- å‘¨Kçº¿å›¾ -->
<div class="card chart-container">
    <div class="chart-header">
        <span class="chart-title">ğŸ“‰ å‘¨Kçº¿ï¼ˆ360å¤©çª—å£ï¼‰</span>
    </div>
    <div id="weeklyChart" style="width: 100%; height: 350px;"></div>
</div>
```

---

### 4. Kçº¿å›¾æ¸²æŸ“é€»è¾‘

#### æ ¸å¿ƒå‡½æ•°ï¼š`renderKlineChart()`

```javascript
function renderKlineChart(containerId, data, title) {
    const container = document.getElementById(containerId);
    const chart = echarts.init(container);
    
    // å‡†å¤‡æ•°æ®æ ¼å¼
    const dates = data.map(d => formatDate(d.trade_date));
    const ohlc = data.map(d => [d.open, d.close, d.low, d.high]);
    const volumes = data.map(d => d.volume || 0);
    
    const option = {
        animation: false,  // å…³é—­åŠ¨ç”»æå‡æ€§èƒ½
        tooltip: {
            trigger: 'axis',
            axisPointer: { type: 'cross' },  // åå­—æ˜Ÿå…‰æ ‡
            formatter: function(params) {
                // æ˜¾ç¤ºOHLCæ•°æ®
            }
        },
        grid: [
            { /* Kçº¿å›¾åŒºåŸŸ */ },
            { /* æˆäº¤é‡åŒºåŸŸ */ }
        ],
        dataZoom: [
            { type: 'inside' },      // é¼ æ ‡æ»šè½®ç¼©æ”¾
            { type: 'slider' }       // æ»‘åŠ¨æ¡ç¼©æ”¾
        ],
        series: [
            {
                type: 'candlestick',  // Kçº¿å›¾
                data: ohlc,
                itemStyle: {
                    color: '#ef5350',      // é˜³çº¿çº¢è‰²
                    color0: '#26a69a',     // é˜´çº¿ç»¿è‰²
                }
            },
            {
                type: 'bar',           // æˆäº¤é‡æŸ±çŠ¶å›¾
                data: volumes
            }
        ]
    };
    
    chart.setOption(option);
}
```

#### é”®ç›˜ç¼©æ”¾åŠŸèƒ½

```javascript
container.addEventListener('keydown', (e) => {
    const currentZoom = chart.getOption().dataZoom[0];
    const range = currentZoom.end - currentZoom.start;
    
    if (e.key === 'ArrowUp') {
        // æ”¾å¤§ï¼ˆç¼©å°èŒƒå›´ï¼‰
        const newRange = Math.max(range * 0.8, 5);
        chart.dispatchAction({
            type: 'dataZoom',
            start: center - newRange / 2,
            end: center + newRange / 2
        });
    } else if (e.key === 'ArrowDown') {
        // ç¼©å°ï¼ˆæ‰©å¤§èŒƒå›´ï¼‰
        const newRange = Math.min(range * 1.25, 100);
        // ...
    }
});
```

**äº¤äº’è¯´æ˜**ï¼š
- âœ… **åå­—æ˜Ÿå…‰æ ‡**ï¼šé€šè¿‡`axisPointer: { type: 'cross' }`å®ç°
- âœ… **é¼ æ ‡æ»šè½®ç¼©æ”¾**ï¼š`dataZoom.type = 'inside'`
- âœ… **é”®ç›˜ç¼©æ”¾**ï¼š`ArrowUp`æ”¾å¤§ï¼Œ`ArrowDown`ç¼©å°
- âœ… **æ‹–æ‹½å¹³ç§»**ï¼šé¼ æ ‡æ‹–æ‹½Kçº¿å›¾
- âœ… **æ»‘åŠ¨æ¡**ï¼šåº•éƒ¨æ»‘åŠ¨æ¡ç²¾ç¡®é€‰æ‹©èŒƒå›´

---

### 5. å®šæ—¶ä»»åŠ¡æœåŠ¡

#### æ–°å»ºæ–‡ä»¶ï¼š`services/scheduler_service.py`

```python
class SchedulerService:
    """å®šæ—¶ä»»åŠ¡æœåŠ¡ç±»"""
    
    def __init__(self):
        self.running = False
        self.last_minute_update = None
        self.last_daily_update = None
    
    def _should_update_minute(self, now):
        """åˆ¤æ–­æ˜¯å¦åº”è¯¥æ›´æ–°1åˆ†é’ŸKçº¿ï¼ˆæ¯5åˆ†é’Ÿï¼‰"""
        minutes_diff = (now - self.last_minute_update).total_seconds() / 60
        return minutes_diff >= 5
    
    def _should_update_daily(self, now):
        """åˆ¤æ–­æ˜¯å¦åº”è¯¥æ›´æ–°æ—¥K/å‘¨Kï¼ˆæ¯24å°æ—¶ï¼‰"""
        hours_diff = (now - self.last_daily_update).total_seconds() / 3600
        return hours_diff >= 24
    
    def _update_minute_data(self):
        """æ›´æ–°æ‰€æœ‰è‡ªé€‰è‚¡çš„1åˆ†é’ŸKçº¿æ•°æ®"""
        watchlist = watchlist_service.get_all_watchlist()
        for stock in watchlist:
            minute_data = stock_service.fetch_minute_data(stock['stock_code'])
            stock_service.save_minute_data(minute_data)
    
    def _update_daily_data(self):
        """æ›´æ–°æ‰€æœ‰è‡ªé€‰è‚¡çš„æ—¥K/å‘¨Kæ•°æ®"""
        watchlist = watchlist_service.get_all_watchlist()
        for stock in watchlist:
            stock_service.update_stock_data(stock['stock_code'])
```

#### å¯åŠ¨å®šæ—¶ä»»åŠ¡

åœ¨`app.py`çš„`init_app()`ä¸­æ·»åŠ ï¼š

```python
from services.scheduler_service import scheduler_service

def init_app():
    # ...
    scheduler_service.start()
    print("å®šæ—¶ä»»åŠ¡å¯åŠ¨å®Œæˆï¼")

if __name__ == '__main__':
    init_app()
    try:
        app.run(host='0.0.0.0', port=5000, debug=config.DEBUG)
    finally:
        scheduler_service.stop()  # åº”ç”¨é€€å‡ºæ—¶åœæ­¢
```

**å®šæ—¶ç­–ç•¥**ï¼š
- ğŸ•’ **1åˆ†é’ŸKçº¿**ï¼šæ¯5åˆ†é’Ÿè‡ªåŠ¨æ›´æ–°
- ğŸ“… **æ—¥K/å‘¨K**ï¼šæ¯24å°æ—¶è‡ªåŠ¨æ›´æ–°
- ğŸ”„ **åå°çº¿ç¨‹**ï¼š`daemon=True`ï¼Œä¸é˜»å¡ä¸»çº¿ç¨‹

---

### 6. ç•Œé¢ä¼˜åŒ–

#### ç§»é™¤AIåˆ†ææŒ‰é’®

**ä¿®æ”¹å‰**ï¼š
```html
<button class="btn btn-success" onclick="analyzeStock()" id="analyzeBtn">AIåˆ†æ</button>
```

**ä¿®æ”¹å**ï¼š
```html
<!-- å·²ç§»é™¤analyzeStock()å‡½æ•°å’ŒæŒ‰é’® -->
```

#### è°ƒæ•´å¸ƒå±€

**CSSä¼˜åŒ–**ï¼š
```css
.chart-panel {
    display: flex;
    flex-direction: column;
    gap: 1rem;  /* å›¾è¡¨ä¹‹é—´é—´è· */
}

.chart-container {
    background: white;
    border-radius: 10px;
    padding: 1rem;
    min-height: 250px;
}
```

---

## ğŸ“Š åŠŸèƒ½æ¼”ç¤º

### 1. é€‰æ‹©è‚¡ç¥¨åçš„ç•Œé¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 300058.SZ æ°¸æ–°è‚¡ä»½                     [æ›´æ–°æ•°æ®] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“ˆ 1åˆ†é’ŸKçº¿ï¼ˆ2å¤©çª—å£ï¼‰                          â”‚
â”‚ [Kçº¿å›¾ + æˆäº¤é‡æŸ±çŠ¶å›¾]                          â”‚
â”‚ [æ»‘åŠ¨æ¡ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• 0%â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€100%]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“Š æ—¥Kçº¿ï¼ˆ60å¤©çª—å£ï¼‰                            â”‚
â”‚ [Kçº¿å›¾ + æˆäº¤é‡æŸ±çŠ¶å›¾]                          â”‚
â”‚ [æ»‘åŠ¨æ¡ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•]                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“‰ å‘¨Kçº¿ï¼ˆ360å¤©çª—å£ï¼‰                           â”‚
â”‚ [Kçº¿å›¾ + æˆäº¤é‡æŸ±çŠ¶å›¾]                          â”‚
â”‚ [æ»‘åŠ¨æ¡ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. é¼ æ ‡æ‚¬åœæ˜¾ç¤ºè¯¦æƒ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2026/02/18 09:35            â”‚
â”‚ å¼€ç›˜: 25.60                 â”‚
â”‚ æ”¶ç›˜: 25.80                 â”‚
â”‚ æœ€ä½: 25.50                 â”‚
â”‚ æœ€é«˜: 25.90                 â”‚
â”‚ æˆäº¤é‡: 123.45ä¸‡            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. é”®ç›˜æ“ä½œ

- **â†‘ (ArrowUp)**ï¼šæ”¾å¤§Kçº¿å›¾ï¼Œç¼©å°æ˜¾ç¤ºèŒƒå›´
- **â†“ (ArrowDown)**ï¼šç¼©å°Kçº¿å›¾ï¼Œæ‰©å¤§æ˜¾ç¤ºèŒƒå›´
- **é¼ æ ‡æ»šè½®**ï¼šä¸Šæ»šæ”¾å¤§ï¼Œä¸‹æ»šç¼©å°
- **é¼ æ ‡æ‹–æ‹½**ï¼šå·¦å³å¹³ç§»Kçº¿å›¾

---

## ğŸ”„ æ•°æ®æ›´æ–°æµç¨‹

### æ‰‹åŠ¨æ›´æ–°

1. ç”¨æˆ·ç‚¹å‡»"æ›´æ–°æ•°æ®"æŒ‰é’®
2. å‰ç«¯è°ƒç”¨`/api/stock/update/{stock_code}`
3. åç«¯æ‰§è¡Œ`update_stock_data()`
4. ä¾æ¬¡è·å–ï¼š1åˆ†é’ŸK â†’ æ—¥K â†’ å‘¨K â†’ æŠ€æœ¯æŒ‡æ ‡
5. ä¿å­˜åˆ°æ•°æ®åº“
6. å‰ç«¯é‡æ–°åŠ è½½Kçº¿å›¾

### è‡ªåŠ¨æ›´æ–°

```
åº”ç”¨å¯åŠ¨
    â†“
å¯åŠ¨å®šæ—¶ä»»åŠ¡çº¿ç¨‹
    â†“
æ¯60ç§’æ£€æŸ¥ä¸€æ¬¡
    â”œâ”€â†’ è·ä¸Šæ¬¡æ›´æ–° â‰¥ 5åˆ†é’Ÿï¼Ÿ â†’ æ›´æ–°1åˆ†é’ŸKçº¿
    â””â”€â†’ è·ä¸Šæ¬¡æ›´æ–° â‰¥ 24å°æ—¶ï¼Ÿ â†’ æ›´æ–°æ—¥K/å‘¨K
```

**æ—¥å¿—è¾“å‡º**ï¼š
```
[2026-02-18 10:05:00] å¼€å§‹æ›´æ–°1åˆ†é’ŸKçº¿æ•°æ®...
  âœ“ 300058.SZ 1åˆ†é’ŸKçº¿å·²æ›´æ–°
  âœ“ 688385.SH 1åˆ†é’ŸKçº¿å·²æ›´æ–°
1åˆ†é’ŸKçº¿æ•°æ®æ›´æ–°å®Œæˆ

[2026-02-19 00:00:00] å¼€å§‹æ›´æ–°æ—¥K/å‘¨Kæ•°æ®...
  âœ“ 300058.SZ æ—¥K/å‘¨Kå·²æ›´æ–°
  âœ“ 688385.SH æ—¥K/å‘¨Kå·²æ›´æ–°
æ—¥K/å‘¨Kæ•°æ®æ›´æ–°å®Œæˆ
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. å›¾è¡¨æ€§èƒ½

```javascript
const option = {
    animation: false,  // å…³é—­åŠ¨ç”»ï¼Œæå‡æ¸²æŸ“é€Ÿåº¦
    // ...
}
```

### 2. æ•°æ®åŠ è½½

```javascript
// å¹¶è¡ŒåŠ è½½ä¸‰ç§å‘¨æœŸæ•°æ®
const [minuteRes, dailyRes, weeklyRes] = await Promise.all([
    fetch('/api/stock/data/...?period=minute&days=1440'),
    fetch('/api/stock/data/...?period=daily&days=60'),
    fetch('/api/stock/data/...?period=weekly&days=52')
]);
```

### 3. æ•°æ®åº“ç´¢å¼•

```sql
-- è‚¡ç¥¨ä»£ç ç´¢å¼•
CREATE INDEX idx_stock_minute_ts_code ON stock_minute(ts_code);

-- æ—¶é—´ç´¢å¼•
CREATE INDEX idx_stock_minute_trade_time ON stock_minute(trade_time);

-- è”åˆæŸ¥è¯¢ä¼˜åŒ–
SELECT * FROM stock_minute 
WHERE ts_code = ? AND trade_time >= ?
ORDER BY trade_time DESC
LIMIT 1440;
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. Tushareæ¥å£é™åˆ¶

- **æ™®é€šç”¨æˆ·**ï¼šæ¯åˆ†é’Ÿ200æ¬¡è°ƒç”¨
- **ç§¯åˆ†ç”¨æˆ·**ï¼šæ ¹æ®ç§¯åˆ†ç­‰çº§æœ‰ä¸åŒé…é¢
- **1åˆ†é’ŸKçº¿**ï¼šéœ€è¦ä¸€å®šç§¯åˆ†æƒé™

**å»ºè®®**ï¼š
- ä½¿ç”¨ç¼“å­˜æœºåˆ¶å‡å°‘APIè°ƒç”¨
- å®šæ—¶ä»»åŠ¡é¿å¼€äº¤æ˜“æ—¶æ®µé¢‘ç¹è°ƒç”¨
- é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

### 2. æ¸¯è‚¡é™åˆ¶

```python
if ts_code.endswith('.HK'):
    print(f"æ¸¯è‚¡æš‚ä¸æ”¯æŒåˆ†é’ŸKçº¿æ•°æ®")
    return []
```

### 3. æ•°æ®å­˜å‚¨

- **1åˆ†é’ŸKçº¿**ï¼šåªä¿ç•™æœ€è¿‘2å¤©ï¼ˆçº¦1440æ¡è®°å½•/è‚¡ç¥¨ï¼‰
- **æ—¥Kçº¿**ï¼šä¿ç•™1å¹´æ•°æ®ï¼ˆçº¦250æ¡è®°å½•/è‚¡ç¥¨ï¼‰
- **å‘¨Kçº¿**ï¼šä¿ç•™2å¹´æ•°æ®ï¼ˆçº¦104æ¡è®°å½•/è‚¡ç¥¨ï¼‰

**ç£ç›˜å ç”¨ä¼°ç®—**ï¼š
- 10åªè‡ªé€‰è‚¡ Ã— (1440 + 250 + 104) Ã— 8å­—æ®µ Ã— 8å­—èŠ‚ â‰ˆ 1MB

---

## ğŸ› å·²çŸ¥é—®é¢˜

### 1. åˆ†é’Ÿæ•°æ®å¯èƒ½ä¸ºç©º

**åŸå› **ï¼š
- Tushareå…è´¹ç”¨æˆ·æ— åˆ†é’Ÿæ•°æ®æƒé™
- éäº¤æ˜“æ—¶æ®µæ— æ–°æ•°æ®

**è§£å†³æ–¹æ¡ˆ**ï¼š
- å‰ç«¯å¢åŠ ç©ºæ•°æ®æç¤º
- åç«¯æ·»åŠ æƒé™æ£€æµ‹

### 2. å“åº”å¼å¸ƒå±€

**é—®é¢˜**ï¼š
- å›¾è¡¨åœ¨å°å±å¹•ä¸Šå¯èƒ½æ˜¾ç¤ºä¸å…¨

**TODO**ï¼š
- æ·»åŠ å“åº”å¼æ–­ç‚¹
- ç§»åŠ¨ç«¯ä¼˜åŒ–æ˜¾ç¤º

---

## ğŸ“ æ–‡ä»¶å˜æ›´æ¸…å•

### æ–°å¢æ–‡ä»¶

1. `services/scheduler_service.py` - å®šæ—¶ä»»åŠ¡æœåŠ¡ï¼ˆ124è¡Œï¼‰

### ä¿®æ”¹æ–‡ä»¶

1. `database/db_manager_sqlite.py` - æ–°å¢`stock_minute`è¡¨ï¼ˆ+28è¡Œï¼‰
2. `services/stock_service.py` - æ–°å¢åˆ†é’ŸKçº¿è·å–å’Œä¿å­˜ï¼ˆ+110è¡Œï¼‰
3. `templates/base.html` - å¼•å…¥EChartsåº“ï¼ˆ+3è¡Œï¼‰
4. `templates/index.html` - é‡æ„Kçº¿å›¾ç•Œé¢ï¼ˆ+200è¡Œï¼Œ-150è¡Œï¼‰
5. `app.py` - å¯åŠ¨å®šæ—¶ä»»åŠ¡ï¼ˆ+10è¡Œï¼‰

### åˆ é™¤åŠŸèƒ½

1. `analyzeStock()`å‡½æ•°ï¼ˆå·²ç§»é™¤ï¼‰
2. `displayStockData()`å‡½æ•°ï¼ˆå·²ç§»é™¤ï¼‰
3. AIåˆ†ææŒ‰é’®ï¼ˆå·²ç§»é™¤ï¼‰

---

## âœ… æµ‹è¯•éªŒè¯

### 1. æ•°æ®åº“åˆå§‹åŒ–

```bash
cd /Users/sunjie/CodeBuddy/ai_quanti
source venv/bin/activate
python3 -c "from database import db_manager; db_manager.init_database()"
```

**è¾“å‡º**ï¼š
```
SQLiteæ•°æ®åº“è·¯å¾„: /Users/sunjie/codebuddy/ai_quanti/data/quanti_stock.db
åˆå§‹åŒ–SQLiteæ•°æ®åº“: /Users/sunjie/codebuddy/ai_quanti/data/quanti_stock.db
SQLiteæ•°æ®åº“åˆå§‹åŒ–å®Œæˆï¼
```

### 2. å¯åŠ¨åº”ç”¨

```bash
source venv/bin/activate
python3 app.py
```

**é¢„æœŸè¾“å‡º**ï¼š
```
æ­£åœ¨åˆå§‹åŒ–æ•°æ®åº“...
æ•°æ®åº“åˆå§‹åŒ–å®Œæˆï¼
ç›®å½•åˆå§‹åŒ–å®Œæˆï¼
æ­£åœ¨å¯åŠ¨å®šæ—¶ä»»åŠ¡...
âœ… å®šæ—¶ä»»åŠ¡å·²å¯åŠ¨
å®šæ—¶ä»»åŠ¡å¯åŠ¨å®Œæˆï¼
 * Running on http://0.0.0.0:5000
```

### 3. è®¿é—®é¡µé¢

1. æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š`http://localhost:5000`
2. æ·»åŠ è‡ªé€‰è‚¡ï¼šè¾“å…¥`300058`æˆ–`688385`
3. ç‚¹å‡»è‚¡ç¥¨é€‰æ‹©
4. ç‚¹å‡»"æ›´æ–°æ•°æ®"æŒ‰é’®
5. ç­‰å¾…Kçº¿å›¾åŠ è½½

### 4. äº¤äº’æµ‹è¯•

- [ ] é¼ æ ‡æ‚¬åœæ˜¾ç¤ºåå­—æ˜Ÿå’Œæ•°æ®æç¤º
- [ ] é¼ æ ‡æ»šè½®ç¼©æ”¾Kçº¿å›¾
- [ ] æŒ‰â†‘é”®æ”¾å¤§Kçº¿å›¾
- [ ] æŒ‰â†“é”®ç¼©å°Kçº¿å›¾
- [ ] æ‹–æ‹½æ»‘åŠ¨æ¡æŸ¥çœ‹å†å²æ•°æ®
- [ ] ç­‰å¾…5åˆ†é’Ÿåæ£€æŸ¥å®šæ—¶ä»»åŠ¡æ—¥å¿—

---

## ğŸ¯ æ€»ç»“

æœ¬æ¬¡æ›´æ–°å®Œæˆäº†ä»¥ä¸‹ç›®æ ‡ï¼š

1. âœ… **æ•°æ®åº“æ‰©å±•**ï¼šæ–°å¢`stock_minute`è¡¨æ”¯æŒ1åˆ†é’ŸKçº¿
2. âœ… **æ•°æ®è·å–**ï¼šå®ç°Tushareåˆ†é’ŸKçº¿APIè°ƒç”¨
3. âœ… **Kçº¿å›¾å±•ç¤º**ï¼šä½¿ç”¨EChartsæ›¿ä»£è¡¨æ ¼ï¼Œæ”¯æŒä¸‰ç§å‘¨æœŸ
4. âœ… **äº¤äº’åŠŸèƒ½**ï¼šåå­—æ˜Ÿå…‰æ ‡ã€é”®ç›˜ç¼©æ”¾ã€é¼ æ ‡æ‹–æ‹½
5. âœ… **è‡ªåŠ¨æ›´æ–°**ï¼šåå°å®šæ—¶ä»»åŠ¡è‡ªåŠ¨åˆ·æ–°æ•°æ®
6. âœ… **ç•Œé¢ä¼˜åŒ–**ï¼šç§»é™¤AIåˆ†ææŒ‰é’®ï¼Œç®€åŒ–æ“ä½œæµç¨‹

**æŠ€æœ¯äº®ç‚¹**ï¼š
- ğŸ¨ EChartsä¸“ä¸šKçº¿å›¾å±•ç¤º
- ğŸ”„ å¤šçº¿ç¨‹åå°å®šæ—¶ä»»åŠ¡
- ğŸ“Š ä¸‰å‘¨æœŸæ•°æ®å¹¶è¡ŒåŠ è½½
- âŒ¨ï¸ ä¸°å¯Œçš„äº¤äº’åŠŸèƒ½
- ğŸš€ é«˜æ€§èƒ½å›¾è¡¨æ¸²æŸ“

**ä¸‹ä¸€æ­¥ä¼˜åŒ–**ï¼š
- [ ] æ·»åŠ æ›´å¤šæŠ€æœ¯æŒ‡æ ‡å åŠ ï¼ˆMACDã€RSIç­‰ï¼‰
- [ ] æ”¯æŒåˆ†æ—¶å›¾åˆ‡æ¢
- [ ] Kçº¿å›¾æˆªå›¾å’Œåˆ†äº«åŠŸèƒ½
- [ ] ç§»åŠ¨ç«¯å“åº”å¼ä¼˜åŒ–
- [ ] å®æ—¶è¡Œæƒ…æ¨é€ï¼ˆWebSocketï¼‰

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [EChartså®˜æ–¹æ–‡æ¡£](https://echarts.apache.org/zh/index.html)
- [Tushare Pro API](https://tushare.pro/document/2)
- [è‚¡ç¥¨é¢„è§ˆæ¨¡å—0.1.md](../é¡¹ç›®å¼€å‘æ–‡æ¡£/è‚¡ç¥¨é¢„è§ˆæ¨¡å—0.1.md)

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**ï¼š2026å¹´2æœˆ18æ—¥  
**ç‰ˆæœ¬å·**ï¼šv0.8  
**çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ
